---
import BtnComprar from "../components/Book/BtnComprar.astro";
import Layout from "../layouts/Layout.astro";
import { books } from "../data/books";
import Title from "../components/Book/Title.astro";
import Model from "../components/three/Model";
import BtnVolver from "../components/Book/BtnVolver.astro";
const { book } = Astro.params
const info = books.find(b => b.id === book)
if (!info) {
  return Astro.redirect("/404")
}
export function getStaticPaths() {
  return [
    {params: {book: "Bandeja-Automontable"}},
    {params: {book: "aprendiendo-git"}},
    {params: {book: "the-clean-coder"}},
    {params: {book: "javascript-the-good-parts"}},
    {params: {book: "eloquent-javascript"}},
    {params: {book: "eloquent-javascript2"}},
  ]
}
const components = import.meta.glob('../components/three/*.jsx')
const nombresDe3ds = [
  "Bandeja-Automontable",
  "aprendiendo-git",
  "the-clean-coder",
  "javascript-the-good-parts",
  "eloquent-javascript",
  "eloquent-javascript2",
]
---
<Layout title={`Libro ${info.title}`}>

  {
    nombresDe3ds.map((nombre) => {
      const Component = components[`../components/three/${info.id}.jsx`]
      return <Component />
    })
  }

  <Model client:load="react" />

  <main class="m-auto max-w-4xl">
    <header class="relative">
      <BtnVolver/>
      <div class="scale-50">
        <Title />
      </div>
    </header>
    <div class="grid grid-cols-1 md:grid-cols-[350px_1fr] gap-x-12 mt-4 md:mt-20 px-8">
      <div class="flex flex-col mb-10">
        <picture class="mb-8 w-full relative border-8">
          <img
          class="aspect-[389/500] h-full object-cover w-full max-w-full rounded"
          src={info.img}
          alt={`Portada del libro ${info.title}`}
          style={`view-transition-name: book-${info.id}`}
          />
        </picture>
        <BtnComprar />
      </div>
      <aside class="mt-10 md:mt-0">
        <h1 class="text-5xl font-black mb-4">{info.title}</h1>
        <p class="text-lg mb-4">{info.opinion}</p>
        <p><strong>Autor:</strong> <span class="font-semibold text-gray-800">{info.author}</span></p>
      </aside>
    </div>
  </main>

</Layout>